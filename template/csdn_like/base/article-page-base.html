<!DOCTYPE html>
<html>
<head>
		<meta charset="UTF-8">
		{% raw config.custom_meta %}
		<meta http-equiv="Cache-Control" content="no-transform" />
		<meta http-equiv="Cache-Control" content="no-siteapp" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
		<title>{{ post['title'] }} - {{ site_name }}</title>

        <meta name="description" content="{{ post['desc'] }}" />
        {% include common-header.html %}
        {% include common-front-header.html %}
        <script src="{{ static_url('ckeditor/plugins/codesnippet/lib/highlight/highlight.pack.js') }}"></script>
        <link rel="stylesheet" href="{{ static_url('ckeditor/plugins/codesnippet/lib/highlight/styles/default.css') }}">
        <link rel="alternate" hreflang="zh-Hant" href="{{ config.site_domain }}/a/{{post['_id']}}" />
        <link rel="alternate" hreflang="zh-Hans" href="{{ config.site_domain }}/a/{{post['_id']}}/zh-cn" />
        {% raw config.analytics_code %}
        {% raw config.adsense_code %}
        <script type="text/javascript" src="{{ static_url('js/article/article.js') }}"></script>
        <!--<script type="text/javascript" src="{{ static_url('js/ads.js') }}"></script>-->
</head>

<body>
    {% block header %}
        {% include ../component/header.html %}
    {% end %}
    {% include ../component/totop.html %}
    <div class="container" id="content-wrapper">
        <div id="toolbox">
            <ul style="position:fixed;">
                {% if 'like' in post and 'article_like' in post['like'] and post['like']['article_like'] > 0 %}
                    {%  set  vote_up_number = 'vote_up_number="{}"'.format(post['like']['article_like']) %}

                {% else %}
                    {% set  vote_up_number = '' %}

                {% end %}
                {%  if data['liked'] %}
                    {%  if data['liked'][0]['value'] == 1  %}
                    <li class="vote vote-up"><i class="icon-thumbs-up-alt active" title="" {% raw vote_up_number %}></i></li>
                    <li class="vote vote-down"><i class="icon-thumbs-down-alt" title=""></i></li>
                    {%  elif data['liked'][0]['value'] == 0  %}
                    <li class="vote vote-up"><i class="icon-thumbs-up-alt" title="" {% raw vote_up_number %}></i></li>
                    <li class="vote vote-down"><i class="icon-thumbs-down-alt active" title="" ></i></li>
                    {% else %}
                        <li class="vote vote-up"><i class="icon-thumbs-up-alt" title="" {% raw vote_up_number %}></i></li>
                        <li class="vote vote-down"><i class="icon-thumbs-down-alt" title="" ></i></li>
                    {% end %}
                {% else %}
                    <li class="vote vote-up"><i class="icon-thumbs-up-alt" title="" {% raw vote_up_number %}></i></li>
                    <li class="vote vote-down"><i class="icon-thumbs-down-alt" title=""></i></li>
                {% end %}
            </ul>
        </div>
        <div class="content">
            {% block menu %}
            {% end %}
            <div class="main-content">
                <div class="article-wrapper">
                    {% block breadcrumb %}
                        {% include ../component/breadcrumb.html %}
                    {% end %}
                    <h1>{{ post['title'] }}</h1>
                    <div class="post-meta">
                        <span class="original">原創</span> 
                        <img src="/static/svgs/user.svg" />
                        <a href="/u/{{ post['user']['_id'] }}" target="_blank">{{ post['user']['user_name'] }}</a>
                        <img src="/static/svgs/clock.svg" />
                        <span> {{ post['post_date'] }} </span>
                    </div>
                    <div class="article-content">
                        {% raw post['content'] %}
                    </div>
                    <div class="ads-article-bottom-match">
                        <ins class="adsbygoogle"
                             style="display:block;"
                             data-ad-format="autorelaxed"
                             data-ad-client="ca-pub-2073744953016040"
                             data-ad-slot="3534050590"></ins>
                        <script>
                            (adsbygoogle = window.adsbygoogle || []).push({});
                        </script>
                    </div>
                    <ul class="tag-list">
                        {% for tag in post['tags'] %}
                        <li>
                            <a href="/t/{{ tag['_id'] }}" target="_blank" class="label-link">{{ tag['name'] }}</a>
                        </li>
                        {% end %}
                    </ul>
                    {% block more-content %}
                    {% end %}
                </div>
            </div>
            <div class="secondary-content feed">
                {% block right_sidebar %}
                {% end %}
            </div>
        </div>
        <div id="myModal" class="modal fade" tabindex="-1" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                        <img src="" class="img-responsive">
                    </div>
                </div>
            </div>
        </div>
        {% block footer %}
            {% include ../component/footer.html %}
        {% end %}
    </div>
<script>
    var post_id = "{{ post['_id'] }}";
    {% if user['is_login'] %}
    var user_id = "{{ user['_id'] }}";
    {% end %}
    var token = getCookie('_xsrf');
</script>
<script>
    $.ajax({
        url: '/views',
        headers: {'X-XSRFToken' : token },
        data: {post_id: post_id },
        type: "POST",
    });
</script>
<script src="{{ static_url('js/custom_fix.js') }}"></script>
<script>
$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
</script>

    <script src="{{ static_url('js/article/load_comments.js') }}"></script>
<script>
$(".article-content img").click(
    function() {
        let width;
        let img_src = $(this).attr('src');
        let img_width = this.naturalWidth;
        // let height = this.naturalHeight;
         let window_width = $(window).width() * 0.8;
         console.log(img_width,window_width)
         if (img_width <= window_width) {
             $("#myModal").addClass('modal-small')
             width = img_width;
         } else {
             $("#myModal").addClass('modal-big')

             width = window_width;
         }

        $("#myModal img").attr('src',img_src);
        $("#myModal .modal-dialog img").css('width',width);
        $("#myModal .modal-dialog img").css('height','auto');

        $('#myModal').modal('show');
    }


    )
    $('#myModal').click(
        function() {
            $('#myModal').modal('hide')
        }
    )

$(".article-content img").lazyload();
</script>
<style>

     .modal-big  .modal-dialog {
            position: relative;
            display: table;
            overflow-y: auto;
            overflow-x: auto;
            width: auto;
        }

     .modal-big   .modal.show .modal-dialog {
            top: 50%;
            transform: translateY(-50%);
        }

     .modal-big   .modal-body {
            text-align: center;
        }

     .modal-small.modal {
        text-align: center;
        padding: 0!important;
    }

     .modal-small.modal:before {
        content: '';
        display: inline-block;
        height: 100%;
        vertical-align: middle;
        margin-right: -4px;
    }

     .modal-small .modal-dialog {
        display: inline-block;
        text-align: left;
        vertical-align: middle;
         max-width: 100%;
    }
     .modal-content {
         cursor: zoom-out;
     }
    </style>
</body>
</html>